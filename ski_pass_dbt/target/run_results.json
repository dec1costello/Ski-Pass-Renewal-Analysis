{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.11.2", "generated_at": "2025-12-30T22:05:19.353903Z", "invocation_id": "45692220-d979-4995-84d8-5ded12956860", "invocation_started_at": "2025-12-30T22:05:16.637596Z", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-30T22:05:18.804824Z", "completed_at": "2025-12-30T22:05:18.812370Z"}, {"name": "execute", "started_at": "2025-12-30T22:05:18.812879Z", "completed_at": "2025-12-30T22:05:18.938224Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.13514065742492676, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.ski_pass_dbt.silver_guest_demographics", "compiled": true, "compiled_code": "\n\nselect\n    cast(\"CUSTOMER KEY\" as integer)    as customer_key,\n    cast(\"AGE\" as integer)             as age,\n    cast(\"RENEWALINSUBSEQUENTSEASON\" as boolean) as renewal_in_subsequent_season,\n    cast(\"STATE\" as varchar)           as guest_state\nfrom read_csv_auto(\n    '../Data/Bronze/guest_demographics.txt',\n    header=true\n)", "relation_name": "\"ski\".\"main\".\"silver_guest_demographics\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-30T22:05:18.945102Z", "completed_at": "2025-12-30T22:05:18.948553Z"}, {"name": "execute", "started_at": "2025-12-30T22:05:18.949729Z", "completed_at": "2025-12-30T22:05:19.038494Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.09479737281799316, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.ski_pass_dbt.silver_guest_transactions", "compiled": true, "compiled_code": "\n\nselect\n    cast(\"PURCHASE KEY\" as integer)   as purchase_key,\n    cast(\"VISIT KEY\" as integer)      as visit_key,\n    cast(\"CUSTOMER KEY\" as integer)   as customer_key,\n    \"PURCHASE DATE\"::timestamp         as purchase_date,\n    upper(\"PURCHASE PRODUCT\")          as purchase_product\nfrom read_csv_auto(\n    '../Data/Bronze/guest_transactions.txt',\n    header=true\n)", "relation_name": "\"ski\".\"main\".\"silver_guest_transactions\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-30T22:05:19.043092Z", "completed_at": "2025-12-30T22:05:19.046483Z"}, {"name": "execute", "started_at": "2025-12-30T22:05:19.046960Z", "completed_at": "2025-12-30T22:05:19.144707Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.10291767120361328, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.ski_pass_dbt.silver_guest_visitation", "compiled": true, "compiled_code": "\n\nselect\n    cast(\"VISIT KEY\" as integer)      as visit_key,\n    cast(\"RESORT KEY\" as integer)     as resort_key,\n    cast(\"CUSTOMER KEY\" as integer)   as customer_key,\n    \"VISIT START DATE\"::timestamp      as visit_start_date,\n    \"VISIT END DATE\"::timestamp        as visit_end_date\nfrom read_csv_auto(\n    '../Data/Bronze/guest_visitation.txt',\n    header=true\n)", "relation_name": "\"ski\".\"main\".\"silver_guest_visitation\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-30T22:05:19.149194Z", "completed_at": "2025-12-30T22:05:19.152661Z"}, {"name": "execute", "started_at": "2025-12-30T22:05:19.153168Z", "completed_at": "2025-12-30T22:05:19.191328Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.044497013092041016, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.ski_pass_dbt.silver_resort_dimensions", "compiled": true, "compiled_code": "\n\nselect\n    cast(\"RESORT KEY\" as integer) as resort_key,\n    upper(\"RESORT\")               as resort,\n    cast(\"STATE\" as varchar)      as resort_state\nfrom read_csv_auto(\n    '../Data/Bronze/resort_dimensions.txt',\n    header=true\n)", "relation_name": "\"ski\".\"main\".\"silver_resort_dimensions\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-30T22:05:19.198395Z", "completed_at": "2025-12-30T22:05:19.202202Z"}, {"name": "execute", "started_at": "2025-12-30T22:05:19.203286Z", "completed_at": "2025-12-30T22:05:19.250879Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.05407381057739258, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.ski_pass_dbt.gold_customer_purchases", "compiled": true, "compiled_code": "\n\nwith purchases as (\n    select \n        customer_key,\n        sum(case when lower(purchase_product) = 'rental' then 1 else 0 end) as total_rentals,\n        sum(case when lower(purchase_product) = 'lesson' then 1 else 0 end) as total_lessons\n    from \"ski\".\"main\".\"silver_guest_transactions\"\n    group by customer_key\n)\n\nselect * from purchases", "relation_name": "\"ski\".\"main\".\"gold_customer_purchases\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-30T22:05:19.256189Z", "completed_at": "2025-12-30T22:05:19.260328Z"}, {"name": "execute", "started_at": "2025-12-30T22:05:19.260826Z", "completed_at": "2025-12-30T22:05:19.297145Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.04230761528015137, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.ski_pass_dbt.gold_customer_trips", "compiled": true, "compiled_code": "\n\nwith base as (\n    select \n        gd.customer_key,\n        gd.age,\n        gd.renewal_in_subsequent_season,\n        gd.guest_state,\n        gv.visit_key,\n        gv.resort_key,\n        gv.visit_start_date,\n        gv.visit_end_date,\n        gt.purchase_key,\n        upper(gt.purchase_product) as purchase_product,\n        rd.resort_state\n    from \"ski\".\"main\".\"silver_guest_demographics\" gd\n    inner join \"ski\".\"main\".\"silver_guest_visitation\" gv\n        on gd.customer_key = gv.customer_key\n    inner join \"ski\".\"main\".\"silver_resort_dimensions\" rd\n        on gv.resort_key = rd.resort_key\n    left join \"ski\".\"main\".\"silver_guest_transactions\" gt\n        on gv.customer_key = gt.customer_key\n       and gv.visit_key = gt.visit_key\n),\n\n-- Feature flags\nflags as (\n    select\n        *,\n        case when guest_state != resort_state then 1 else 0 end as fe_out_of_state_trip,\n        date_diff('day', visit_start_date, visit_end_date) + 1 as fe_trip_length_in_days,\n        case when extract(dow from visit_start_date) in (0,6) then 1 else 0 end as fe_is_weekend\n    from base\n),\n\n-- Unique trips per customer\nunique_trips as (\n    select distinct customer_key, visit_key, fe_out_of_state_trip, fe_trip_length_in_days, fe_is_weekend,\n           visit_start_date, visit_end_date\n    from flags\n),\n\n-- Compute gaps first\ntrips_with_gaps as (\n    select\n        *,\n        date_diff('day', lag(visit_end_date) over (partition by customer_key order by visit_start_date), visit_start_date) as gap_days\n    from unique_trips\n),\n\n-- Aggregated features per customer\ncustomer_agg as (\n    select\n        customer_key,\n        min(fe_trip_length_in_days) as min_trip_length,\n        max(fe_trip_length_in_days) as max_trip_length,\n        avg(fe_trip_length_in_days) as avg_trip_length,\n        sum(fe_trip_length_in_days) as total_days_on_mountain,\n        sum(case when fe_out_of_state_trip = 0 then fe_trip_length_in_days else 0 end) as total_days_in_state,\n        sum(case when fe_out_of_state_trip = 1 then fe_trip_length_in_days else 0 end) as total_days_out_of_state,\n        count(visit_key) as total_trips,\n        sum(case when fe_out_of_state_trip = 0 then 1 else 0 end) as total_trips_in_state,\n        sum(case when fe_out_of_state_trip = 1 then 1 else 0 end) as total_trips_out_of_state,\n        avg(fe_out_of_state_trip) as pct_trips_out_of_state,\n        max(gap_days) as biggest_gap_days,\n        min(gap_days) as smallest_gap_days,\n        avg(gap_days) as avg_gap_days\n    from trips_with_gaps\n    group by customer_key\n)\n\nselect * from customer_agg", "relation_name": "\"ski\".\"main\".\"gold_customer_trips\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-30T22:05:19.302671Z", "completed_at": "2025-12-30T22:05:19.306944Z"}, {"name": "execute", "started_at": "2025-12-30T22:05:19.307434Z", "completed_at": "2025-12-30T22:05:19.342646Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.04207921028137207, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.ski_pass_dbt.gold_customer_features", "compiled": true, "compiled_code": "\n\nwith trips as (\n\n    select *\n    from \"ski\".\"main\".\"gold_customer_trips\"\n\n),\n\npurchases as (\n\n    select *\n    from \"ski\".\"main\".\"gold_customer_purchases\"\n\n),\n\ndemographics as (\n\n    select\n        customer_key,\n        age,\n        guest_state,\n        renewal_in_subsequent_season\n    from \"ski\".\"main\".\"silver_guest_demographics\"\n\n)\n\nselect\n    -- -------------------------------------------------\n    -- Identifiers\n    -- -------------------------------------------------\n    t.customer_key,\n\n    -- -------------------------------------------------\n    -- Label & static customer attributes\n    -- -------------------------------------------------\n    d.renewal_in_subsequent_season,\n    d.age,\n    d.guest_state,\n\n    -- -------------------------------------------------\n    -- Trip behavior (raw)\n    -- -------------------------------------------------\n    t.min_trip_length,\n    t.max_trip_length,\n    t.avg_trip_length,\n    t.total_days_on_mountain,\n    t.total_days_in_state,\n    t.total_days_out_of_state,\n    t.total_trips,\n    t.total_trips_in_state,\n    t.total_trips_out_of_state,\n    t.pct_trips_out_of_state,\n    t.biggest_gap_days,\n    t.smallest_gap_days,\n    t.avg_gap_days,\n\n    -- -------------------------------------------------\n    -- Purchase behavior (raw)\n    -- -------------------------------------------------\n    coalesce(p.total_rentals, 0) as total_rentals,\n    coalesce(p.total_lessons, 0) as total_lessons,\n\n    -- -------------------------------------------------\n    -- ML-derived features (previously in Python)\n    -- -------------------------------------------------\n\n    -- Single-trip customer flag\n    case\n        when t.total_trips = 1 then 1\n        else 0\n    end as is_single_trip_customer,\n\n    -- Zero-inflation flags\n    case\n        when t.total_trips_out_of_state > 0 then 1\n        else 0\n    end as total_trips_out_of_state_nonzero,\n\n    case\n        when t.total_days_out_of_state > 0 then 1\n        else 0\n    end as total_days_out_of_state_nonzero,\n\n    case\n        when t.pct_trips_out_of_state > 0 then 1\n        else 0\n    end as pct_trips_out_of_state_nonzero,\n\n    case\n        when coalesce(p.total_lessons, 0) > 0 then 1\n        else 0\n    end as total_lessons_nonzero,\n\n    -- Gap null handling (explicit, stable)\n    coalesce(t.biggest_gap_days, 0)  as biggest_gap_days_filled,\n    coalesce(t.smallest_gap_days, 0) as smallest_gap_days_filled,\n    coalesce(t.avg_gap_days, 0)      as avg_gap_days_filled\n\nfrom trips t\nleft join purchases p\n    on t.customer_key = p.customer_key\nleft join demographics d\n    on t.customer_key = d.customer_key", "relation_name": "\"ski\".\"main\".\"gold_customer_features\"", "batch_results": null}], "elapsed_time": 0.8267090320587158, "args": {"show_resource_report": false, "populate_cache": true, "show_all_deprecations": false, "introspect": true, "require_unique_project_resource_names": false, "log_level_file": "debug", "invocation_command": "dbt run", "state_modified_compare_more_unrendered_values": false, "which": "run", "require_resource_names_without_spaces": true, "log_format": "default", "require_nested_cumulative_type_params": false, "empty": false, "log_path": "C:\\Users\\decla\\Desktop\\Ski-Pass-Renewal-Prediction\\ski_pass_dbt\\logs", "require_ref_searches_node_package_before_root": false, "send_anonymous_usage_stats": true, "macro_debugging": false, "print": true, "printer_width": 80, "require_all_warnings_handled_by_warn_error": false, "state_modified_compare_vars": false, "project_dir": "C:\\Users\\decla\\Desktop\\Ski-Pass-Renewal-Prediction\\ski_pass_dbt", "write_json": true, "profiles_dir": "C:\\Users\\decla\\.dbt", "use_colors_file": true, "log_format_file": "debug", "require_yaml_configuration_for_mf_time_spines": false, "source_freshness_run_project_hooks": true, "require_batched_execution_for_custom_microbatch_strategy": false, "exclude": [], "strict_mode": false, "partial_parse": true, "upload_to_artifacts_ingest_api": false, "use_colors": true, "indirect_selection": "eager", "log_file_max_bytes": 10485760, "use_fast_test_edges": false, "version_check": true, "log_level": "info", "favor_state": false, "require_explicit_package_overrides_for_builtin_materializations": true, "validate_macro_args": false, "require_generic_test_arguments_property": true, "cache_selected_only": false, "quiet": false, "warn_error_options": {"error": [], "warn": [], "silence": []}, "vars": {}, "static_parser": true, "select": [], "skip_nodes_if_on_run_start_fails": false, "defer": false, "partial_parse_file_diff": true}}